(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{372:function(e,t){function n(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id=372},407:function(e,t){},409:function(e,t){},420:function(e,t,n){"use strict";n.r(t);var r=n(11),o=(n(55),n(39),n(44),n(323),n(31),n(38),n(78),n(143),n(346),n(49),n(99)),c=n(140),l=n(141),h=(n(46),n(30),n(347)),d=n.n(h),f=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(c.a)(this,e),this.options={showServerDebug:!0,socket:"ws://54.169.221.249:8000",peer:{host:"54.169.221.249",port:9e3,path:"/"}},this.signalClient=null,this.localStream=null,this.remoteSteam=[],this.peerConnection=null,this.peers=[],this.state="idle",this.meet={username:"",name:"",meetId:null,peers:[],players:[]},this.binds={onConnected:[],onDisconnected:[],onJoined:[],onNewClientConnected:[],onRetrieveClientList:[],onStateChange:[]},this.options=Object.assign(this.options,t),this.signalClient=n(373)(this.options.socket),this.bindSignalClient(),this.serverResponse("connecting to server..."),this.changeState("connecting")}var t;return Object(l.a)(e,[{key:"addBind",value:function(e,t){this.binds[e].push(t)}},{key:"changeState",value:function(e){this.state=e,this.runBindFunctions("onStateChange")}},{key:"runBindFunctions",value:(t=Object(r.a)(regeneratorRuntime.mark((function e(t){var n,i,r,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=this.binds[t],i=0;case 2:if(!(i<n.length)){e.next=10;break}return r=n[i],o={signalClient:this.signalClient,peerConnection:this.peerConnection,localStream:this.localStream,remoteSteam:this.remoteSteam,state:this.state,meet:this.meet},e.next=7,r(o);case 7:i++,e.next=2;break;case 10:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"serverResponse",value:function(data){this.options.showServerDebug&&console.log("[server] : ".concat(data))}},{key:"joinMeet",value:function(e,t){"connected"===this.state&&(this.serverResponse("joining..."),this.changeState("joining"),this.meet={username:t,meetId:e},this.signalClient.emit("join",{meetId:e,username:t}))}},{key:"onSocketConnected",value:function(){var e=this;this.peerConnection=new d.a(this.signalClient.id,this.options.peer),this.peerConnection.on("connection",(function(e){e.on("data",(function(data){console.log(data)}))})),this.peerConnection.on("call",(function(t){t.answer(e.localStream),console.log("menjawab ",t.peer)}))}},{key:"send",value:function(e,t){var data={meetId:this.meet.meetId};this.signalClient.emit(e,Object.assign(data,t))}},{key:"bindSignalClient",value:function(){var e=this,t=this.signalClient;t.on("connect",Object(r.a)(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return e.onSocketConnected(),n.next=3,e.runBindFunctions("onConnected");case 3:e.serverResponse("connected to server with id ".concat(t.id)),e.changeState("connected");case 5:case"end":return n.stop()}}),n)})))),t.on("disconnect",Object(r.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.runBindFunctions("onDisconnected");case 2:e.serverResponse("disconnected from server"),e.changeState("disconnected");case 4:case"end":return t.stop()}}),t)})))),t.on("joined",function(){var t=Object(r.a)(regeneratorRuntime.mark((function t(data){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.runBindFunctions("onJoined");case 2:e.meet.meetId=data.id,e.meet.name=data.name,e.serverResponse("joined"),e.changeState("joined");case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),t.on("client-connected",function(){var n=Object(r.a)(regeneratorRuntime.mark((function n(data){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(data!==t.id){n.next=2;break}return n.abrupt("return");case 2:return n.next=4,e.runBindFunctions("onNewClientConnected");case 4:e.serverResponse("new client connected : ".concat(data));case 5:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()),t.on("client-list",function(){var t=Object(r.a)(regeneratorRuntime.mark((function t(data){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.runBindFunctions("onRetrieveClientList");case 2:try{e.meet.players=Array.from(data.clientList)}catch(t){e.meet.players=[]}case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),this.signalClient=t}}]),e}(),m=n(418),v=n(419),y=n(391),w=n(133);n(40),n(16),n(392);function x(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(y.a)(e);if(t){var o=Object(y.a)(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Object(v.a)(this,n)}}var k="image",S="sprite",C="tileset",j=function(){function e(t){var n=this;Object(c.a)(this,e),this.get=function(e){return n.resources.find((function(t){return t.key===e}))},this.game=t,this.queueResources=[],this.resources=[]}var t;return Object(l.a)(e,[{key:"add",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:k,t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};this.queueResources.push({type:e,key:t,url:n,options:r})}},{key:"load",value:(t=Object(r.a)(regeneratorRuntime.mark((function e(){var t,i,n,r,o,c,l=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=regeneratorRuntime.mark((function e(i){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=l.queueResources[i],n=function(){return new Promise((function(e,t){return e()}))},t.type!==k&&t.type!==S&&t.type!==C||(n=function(){return new Promise((function(e,n){t.image=new Image,t.image.onload=function(){t.loaded=!0,e()},t.image.onerror=function(){t.error=!0,e()},t.image.src=t.url}))}),e.next=5,n();case 5:case"end":return e.stop()}}),e)})),i=0;case 2:if(!(i<this.queueResources.length)){e.next=7;break}return e.delegateYield(t(i),"t0",4);case 4:i++,e.next=2;break;case 7:for(n=Object(w.a)(this.queueResources.filter((function(e){return e.loaded}))),r=Object(w.a)(this.queueResources.filter((function(e){return e.error}))),this.queueResources=[],o=0;o<n.length;o++)(c=n[o]).type===k&&this.resources.push(new O(c)),c.type===S&&this.resources.push(new R(c)),c.type===C&&this.resources.push(new z(c));return e.abrupt("return",{loaded:n,error:r});case 12:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),e}(),_=function e(t){Object(c.a)(this,e),this.key=t.key,this.resource=t},O=function(e){Object(m.a)(n,e);var t=x(n);function n(e){var r;return Object(c.a)(this,n),(r=t.apply(this,arguments)).image=e.image,r}return n}(_),R=function(e){Object(m.a)(n,e);var t=x(n);function n(e){var r;return Object(c.a)(this,n),(r=t.apply(this,arguments)).image=e.image,r}return n}(_),z=function(e){Object(m.a)(n,e);var t=x(n);function n(e){var r;return Object(c.a)(this,n),(r=t.apply(this,arguments)).image=e.image,r}return n}(_),I=n(25),M=(n(79),n(45),n(57),n(145),n(394)),D={view:{grid:!1,collision:!1}},A=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object(c.a)(this,e),this.objects=[],this.offset={x:0,y:0},this.game=t,this.mapData={},this.tilesets=[],this.tileOutputSize=1,this.mapTiles=[],this.options=Object.assign(D,n)}var t,n,o;return Object(l.a)(e,[{key:"draw",value:function(e){for(var t=this,n=e.canvasContext,r=e.applyPlugins,o=this.offset,i=0;i<this.objects.length;i++){var object=this.objects[i];object.update(e,object,object.state),r(e,"update")}var c=this.tileOutputSize,l=this.tileSize.width*c,h=this.tileSize.height*c;n.clearRect(0,0,e.ctx.canvas.width,e.ctx.canvas.height);for(var d=[],f=0;f<this.layers.length;f++)for(var m=this.layers[f],v=function(e){var r=m.data[e];if(!r)return"continue";var c=e%t.mapSize.width,f=Math.floor(e/t.mapSize.width),v=t.mapTiles.find((function(e){return e.id===r})),y=Math.floor(o.x+c*l),w=Math.floor(o.y+f*h);if(n.drawImage(v.resource.image,v.sourceX,v.sourceY,t.tileSize.width,t.tileSize.height,y,w,l,h),t.options.view.collision){var x=t.mapCollision.find((function(e){return parseInt(e.id)===parseInt(r)}));if(x){var k=x.data;d.push({x:y+k.x,y:w+k.y,width:k.width,height:k.height})}}},y=0;y<m.data.length;y++)v(y);for(var w=0;w<this.objects.length;w++){var x=this.objects[w];x.render(e,x,x.state)}if(this.options.view.grid)for(var col=0;col<this.mapSize.height;col++)for(var k=col*l,S=0;S<this.mapSize.width;S++){var C=S*h;n.beginPath(),n.rect(C,k,l,h),n.strokeStyle="white",n.stroke()}if(this.options.view.collision){n.beginPath(),n.rect(o.x,o.y,l*this.mapSize.width,h*this.mapSize.height),n.strokeStyle="red",n.stroke();for(var j=0;j<d.length;j++){var a=d[j];n.beginPath(),n.rect(a.x,a.y,a.width,a.height),n.strokeStyle="red",n.stroke()}}r(e,"render")}},{key:"mappingTileSet",value:function(){for(var e=this.tilesets,t=this.game.resourceManager,n=[],r=[],i=0;i<e.length;i++){for(var o=e[i],c=this.mapData.tilesets[i].firstgid,l=0;l<o.image.length;l++)for(var image=o.image[l].$,h=t.get("".concat(o.$.name,"___").concat(image.source)),d=image.height/this.tileSize.height,f=image.width/this.tileSize.width,m=0;m<d;m++)for(var v=0;v<f;v++){var y=c;n.push({id:y,tileset_name:"".concat(o.$.name,"___").concat(image.source),sourceX:v*this.tileSize.width,sourceY:m*this.tileSize.height,col:d,row:f,resource:h}),c++}for(var w=0;w<o.tile.length;w++){var x=o.tile[w],data=x.objectgroup[0].object[0].$;r.push({id:parseInt(x.$.id)+1,data:{x:parseInt(data.x),y:parseInt(data.y),width:parseInt(data.width),height:parseInt(data.height),id:parseInt(data.id)}})}}this.mapTiles=n,this.mapCollision=r}},{key:"loadFromHttp",value:(o=Object(r.a)(regeneratorRuntime.mark((function e(t,n){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,this.mapUrl=n,this.mapBaseUrl=n.split("/").slice(0,-1).join("/")+"/",e.next=5,t.get(n);case 5:return r=e.sent,this.mapData=r.data,this.mapSize={width:this.mapData.width,height:this.mapData.height},this.tileSize={width:this.mapData.tilewidth,height:this.mapData.tileheight},this.layers=this.mapData.layers,e.next=12,this.loadTileset(t);case 12:return e.next=14,this.loadAllResources();case 14:return e.next=16,this.mappingTileSet();case 16:return e.abrupt("return",!0);case 19:return e.prev=19,e.t0=e.catch(0),console.log("cannt load map from url:",n),console.log(e.t0),e.abrupt("return",!1);case 24:case"end":return e.stop()}}),e,this,[[0,19]])}))),function(e,t){return o.apply(this,arguments)})},{key:"loadTileset",value:(n=Object(r.a)(regeneratorRuntime.mark((function e(t){var n,i,r,o,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,n=this.mapData.tilesets,i=0;case 3:if(!(i<n.length)){e.next=15;break}return r=n[i],e.next=7,t.get(this.mapBaseUrl+r.source);case 7:return o=e.sent,e.next=10,Object(M.parseStringPromise)(o.data);case 10:a=e.sent,this.tilesets.push(a.tileset);case 12:i++,e.next=3;break;case 15:e.next=22;break;case 17:return e.prev=17,e.t0=e.catch(0),console.log("cannt load map because tileset cannt load."),console.log(e.t0),e.abrupt("return",!1);case 22:case"end":return e.stop()}}),e,this,[[0,17]])}))),function(e){return n.apply(this,arguments)})},{key:"loadAllResources",value:(t=Object(r.a)(regeneratorRuntime.mark((function e(){var t,i,n,r,image;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t=this.game.resourceManager,i=0;i<this.tilesets.length;i++)for(n=this.tilesets[i],r=0;r<n.image.length;r++)image=n.image[r].$,t.add(C,"".concat(n.$.name,"___").concat(image.source),this.mapBaseUrl+image.source,{width:image.width,height:image.height});return e.next=4,t.load();case 4:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"addObject",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){},o=this.objects.findIndex((function(t){return t.id===e}));o>-1?this.objects[o]=new P(e,t,n,r):this.objects.push(new P(e,t,n,r))}},{key:"getObject",value:function(e){return this.objects.find((function(t){return t.id===e}))}},{key:"deleteObject",value:function(e){var t=this.objects.findIndex((function(t){return t.id===e}));t>-1&&this.objects.splice(t,1)}},{key:"checkCollision",value:function(e,t,n,r){var o=this,c=this.offset,l=!1,h=this.tileSize.width*this.mapSize.width+c.x,d=this.tileSize.height*this.mapSize.height+c.y;if(e+=c.x,t+=c.y,e<0)return!0;if(t<0)return!0;if(e+n>=h*this.tileOutputSize)return!0;if(t+r>=d*this.tileOutputSize)return!0;for(var f=this.tileOutputSize,m=this.tileSize.width*f,v=this.tileSize.height*f,i=0;i<this.layers.length;i++)for(var y=this.layers[i],w=function(h){var d=y.data[h];if(!d)return"continue";var f=h%o.mapSize.width,w=Math.floor(h/o.mapSize.width),x=f*m+c.x,k=w*v+c.y,S=o.mapCollision.find((function(e){return e.id===d}));if(S){var C=S.data;if(e+n>=x+C.x&&e<=x+C.x+C.width&&t+r>=k+C.y&&t<=k+C.y+C.height)return l=!0,{v:!0}}},x=0;x<y.data.length;x++){var k=w(x);if("continue"!==k&&"object"===Object(I.a)(k))return k.v}return l}}]),e}(),P=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){};Object(c.a)(this,e),this.id=t,this.state=n,this.update=r,this.render=o}return Object(l.a)(e,[{key:"setState",value:function(e){this.state=Object.assign(this.state,e)}},{key:"getState",value:function(){return this.state}}]),e}(),F={fps:60,character:{speed:3}},T=function(){function e(canvas){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];Object(c.a)(this,e),this.animationFrame=void 0,this.frameIndex=0,this.timeThen=void 0,this.timeNow=void 0,this.fpsInterval=0,this.canvas=canvas,this.ctx=canvas.getContext("2d"),this.options=Object.assign(F,t),this.plugins=n,this.updateFunctions=[],this.resourceManager=new j(this),this.map=new A(this)}return Object(l.a)(e,[{key:"bindUpdate",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){};return this.updateFunctions.push(e),this}},{key:"start",value:function(){this.fpsInterval=1e3/this.options.fps,this.timeThen=Date.now(),this.startTime=this.timeThen,this.animationFrame=requestAnimationFrame(this.update.bind(this)),this.plugin({plugins:this.plugins,map:this.map,resourceManager:this.resourceManager,canvas:this.canvas,canvasContext:this.ctx,options:this.options},this.plugins,"start")}},{key:"stop",value:function(){this.animationFrame&&(cancelAnimationFrame(this.animationFrame),this.animationFrame=void 0),this.plugin({plugins:this.plugins,map:this.map,resourceManager:this.resourceManager,canvas:this.canvas,canvasContext:this.ctx,options:this.options},this.plugins,"start")}},{key:"plugin",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,i=0;i<t.length;i++){var r=t[i];n?r(e)[n](e):r(e)}}},{key:"update",value:function(e){var t=this;this.animationFrame=requestAnimationFrame(this.update.bind(this)),this.timeNow=Date.now();var n=this.timeNow-this.timeThen;if(n>this.fpsInterval){var r=this.timeNow-this.startTime,o=Math.round(Math.round(1e3/(r/this.frameIndex)*100)/100);this.timeThen=this.timeNow-n%this.fpsInterval;for(var c={plugins:this.plugins,map:this.map,resourceManager:this.resourceManager,canvas:this.canvas,canvasContext:this.ctx,options:this.options,frame:this.frameIndex,fps:o,timeStart:this.timeStart,timeNow:this.timeNow,timeThen:this.timeThen,ctx:this.ctx,timestamp:e,applyPlugins:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,r=e.plugins;t.plugin(e,r,n)}},i=0;i<this.updateFunctions.length;i++){(0,this.updateFunctions[i])(c)}this.frameIndex++}}}]),e}(),B=function(){return{start:function(){},update:function(){},render:function(e){var t=e.fps,n=(e.screen,e.ctx);n.fillStyle="red",n.font="20px Arial",n.textBaseline="top",n.alignText="left",n.fillText("".concat(t),5,5)},stop:function(){}}},U=function(){return{start:function(e){console.log(e)},update:function(){},render:function(){},stop:function(){}}};function N(e,t,n){return $.apply(this,arguments)}function $(){return($=Object(r.a)(regeneratorRuntime.mark((function e(t,n,data){var r,o,c,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={showRadius:!0},t.resourceManager.add(S,"character_femalestaffdark_yellow","/characters/femalestaffdark_yellow.png"),e.next=4,t.resourceManager.load();case 4:return o=t.resourceManager.get("character_femalestaffdark_yellow"),c={direction:"bottom",scene:0,x:data.x||0,y:data.y||0,frameCycle:0,cycleChar:[0,0,0],keysMap:[]},t.map.offset={x:t.canvas.width/2-t.map.tileSize.width-c.x,y:t.canvas.height/2-t.map.tileSize.height-c.y},t.map.addObject("my_character",c,(function(e,object,r){var map=e.map,o=r.keysMap,c=r.x,l=r.y,h=r.cycleChar,d=r.direction,f=t.options.character.speed;if(0!==o.length&&o.find((function(e){return!0===e}))){var m=map.tileSize.width*map.tileOutputSize,v=map.tileSize.height*map.tileOutputSize,y=c,w=l;if(!0===o[68]?(d="right",h=[9,10,11],y+=f):!0===o[87]?(d="up",h=[6,7,8],w-=f):!0===o[65]?(d="left",h=[3,4,5],y-=f):!0===o[83]&&(d="bottom",h=[0,1,2],w+=f),t.map.offset={x:t.canvas.width/2-t.map.tileSize.width-y,y:t.canvas.height/2-t.map.tileSize.height-w},map.checkCollision(y,w,m,v))return;r.cycleChar=h,object.setState({x:y,y:w,direction:d}),n.send("player-action",{action:"move",data:{x:y,y:w,direction:d}})}else"bottom"===d?h=[0,0,0]:"left"===d?h=[3,3,3]:"up"===d?h=[6,6,6]:"right"===d&&(h=[9,9,9]),r.cycleChar=h}),(function(e,object,t){var n=e.canvasContext,map=e.map,c=e.frame,l=t.cycleChar,h=l[t.frameCycle],d=t.x+map.offset.x,f=t.y+map.offset.y,m=map.tileSize.width*map.tileOutputSize,v=map.tileSize.height*map.tileOutputSize,y=h*map.tileSize.width,w=map.tileSize.width,x=map.tileSize.height;if(n.drawImage(o.image,y,0,w,x,d,f,m,v),r.showRadius){var circle={x:d+m/2,y:f+v/2};n.beginPath(),n.strokeStyle="blue",n.arc(circle.x,circle.y,100,0,2*Math.PI),n.stroke()}c%15==0&&(t.frameCycle>=l.length-1&&(t.frameCycle=-1),t.frameCycle++)})),l=[],document.addEventListener("keydown",(function(e){var n=t.map.getObject("my_character");l[e.keyCode]=!0,n.setState({keysMap:l})})),document.addEventListener("keyup",(function(e){var n=t.map.getObject("my_character");l[e.keyCode]=!1,n.setState({keysMap:l})})),e.abrupt("return",t);case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var L=Object(o.b)({setup:function(){var e,t=Object(o.h)(),n=t.$axios,c=t.$sleep,l=[B,U],h=Object(o.f)(!1),d=Object(o.f)([]),m=Object(o.a)((function(){return d.value.filter((function(e){return"videoinput"===e.kind}))})),v=Object(o.a)((function(){return d.value.filter((function(e){return"audioinput"===e.kind}))})),y=Object(o.f)(["public_room"]),w=Object(o.f)(!1),x=Object(o.f)(0),k=Object(o.f)(0),S=Object(o.f)("public_demo"),C=Object(o.f)("guest_".concat(Math.floor(100*Math.random())+1)),j=function(){var e=new f,t=Object(o.f)("idle");e.addBind("onStateChange",(function(e){var n=e.state;t.value=n,console.log("state change : ",n)}));var n=function(){},c=function(){var t=Object(r.a)(regeneratorRuntime.mark((function t(n,r){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.joinMeet(n,r);case 2:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}();return{socket:e,socketState:t,socketInit:n,socketJoinMeet:c}}(),_=j.socket,O=j.socketState,R=j.socketInit,z=j.socketJoinMeet,I=Object(o.f)([]),M=function(e,t,n){var r=Object(o.f)([]),c=function(e,object,t){var n=t.direction,r=t.cycleChar;"bottom"===n?r=[0,0,0]:"left"===n?r=[3,3,3]:"up"===n?r=[6,6,6]:"right"===n&&(r=[9,9,9]),object.setState({cycleChar:r})},l=function(e,object,t){var n=e.canvasContext,map=e.map,r=e.resourceManager,o=e.frame,c=t.cycleChar,l=c[t.frameCycle],h=r.get("character_femalestaffdark_yellow"),d=t.x+map.offset.x,f=t.y+map.offset.y,m=map.tileSize.width*map.tileOutputSize,v=map.tileSize.height*map.tileOutputSize,y=0,w=l*map.tileSize.width,x=map.tileSize.width,k=map.tileSize.height;n.drawImage(h.image,w,y,x,k,d,f,m,v);var S=map.tileSize.width/2;n.fillStyle="black",n.font="8px Arial",n.textAlign="center",n.textBaseline="top",n.fillText(t.name,d+S,f-S),o%15==0&&(t.frameCycle>=c.length-1&&(t.frameCycle=-1),t.frameCycle++)},h=function(e,n){var map=e.map;t.peerConnection.call(n.id,t.localStream).on("stream",(function(e){try{document.querySelector("#player_video_".concat(n.id)).srcObject=e,console.log("lagi nelpon")}catch(e){}})),r.value.push({id:n.id,name:n.name,player:n});var o=r.value.find((function(e){return e.id===n.id})),h={id:n.id,name:n.name,frameCycle:0,cycleChar:[0,0,0],x:n.data.x||0,y:n.data.y||0,direction:n.data.direction,player:o,calling:!1};map.addObject("character_player_".concat(n.id),h,c,l)},d=function(e,t){e.map.deleteObject("character_player_".concat(t.id))},f=function(e){for(var o=[],c=[],l=n.value.filter((function(e){return e.id!==t.signalClient.id})),f=function(i){if(r.value.findIndex((function(e){return e.id===l[i].id}))>-1){var t=r.value[i];c.push(t.id)}else{var n=l[i];o.push(n.id),h(e,n)}},i=0;i<l.length;i++)f(i);for(var m=0;m<r.value.length;m++){var v=r.value[m];c.includes(v.id)||o.includes(v.id)||(d(e,v),r.value.splice(m,1))}};return{registeredPlayer:r,playersInit:function(e,t){t.signalClient.on("player-action",(function(data){switch(data.action){case"move":var t=data.data||{x:0,y:0,direction:"bottom"},object=e.map.getObject("character_player_".concat(data.id));object&&object.setState({x:t.x,y:t.y,direction:t.direction})}}))},playersUpdate:f,playersRender:function(e){var canvas=e.canvas,n=e.ctx,o=5;n.fillStyle="red",n.font="20px Arial",n.textBaseline="bottom",n.fillText("Meet : ".concat(t.meet.name," | Players Online : ").concat(r.value.length+1),o,canvas.height-o)}}}(0,_,I),D=M.registeredPlayer,A=M.playersInit,P=M.playersUpdate,F=M.playersRender,$=!1,L=function(){var t=Object(r.a)(regeneratorRuntime.mark((function t(data){var r,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=document.querySelector("canvas#game"),e=new T(r,{},l),o=function(){r.width=r.clientWidth,r.height=r.clientHeight},window.addEventListener("resize",o),o(),t.next=7,e.map.loadFromHttp(n,"/map/demo/demo2.json");case 7:return t.next=9,N(e,_,data);case 9:return t.next=11,A(e,_);case 11:e.bindUpdate(E),e.start();case 13:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),E=function(e){var map=e.map;P(e),map.draw(e),F(e)},J=function(){var e=Object(r.a)(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,navigator.mediaDevices.enumerateDevices();case 2:d.value=e.sent;case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),H=function(){var e=Object(r.a)(regeneratorRuntime.mark((function e(){var t,n,video,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!("mediaDevices"in navigator)||!("getUserMedia"in navigator.mediaDevices)){e.next=21;break}if(!navigator.mediaDevices.getUserMedia){e.next=21;break}return t={deviceId:{exact:m.value[x.value].deviceId}},n={deviceId:{exact:v.value[k.value].deviceId}},e.prev=4,h.value=!0,e.next=8,c(100);case 8:return video=document.querySelector(".self_cam .self_cam__container video"),e.next=11,navigator.mediaDevices.getUserMedia({video:t,audio:n});case 11:r=e.sent,_.localStream=r,video.srcObject=r,e.next=21;break;case 16:e.prev=16,e.t0=e.catch(4),h.value=!1,console.log("Something went wrong!"),console.log(e.t0);case 21:case"end":return e.stop()}}),e,null,[[4,16]])})));return function(){return e.apply(this,arguments)}}(),Y=function(){var e=Object(r.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return _.addBind("onJoined",Object(r.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,H();case 2:case"end":return e.stop()}}),e)})))),_.addBind("onRetrieveClientList",function(){var e=Object(r.a)(regeneratorRuntime.mark((function e(t){var n,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.meet,I.value=Array.isArray(n.players)?n.players:[],$){e.next=8;break}if(!(a=I.value.find((function(e){return e.id===_.signalClient.id})))){e.next=8;break}return $=!0,e.next=8,L(a.data);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),_.addBind("onDisconnected",(function(){h.value=!1})),e.next=5,z(S.value,C.value);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),X=function(){var e=Object(r.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,L();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(o.e)(Object(r.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,R();case 2:return e.next=4,J();case 4:case"end":return e.stop()}}),e)})))),Object(o.d)((function(){e&&e.stop(),_.signalClient.disconnect()})),{socketState:O,inputDeviceInfo:d,cameraDevice:m,audioDevice:v,meetings:y,players:I,registeredPlayer:D,muteAudio:w,selectCamera:x,selectAudio:k,selectUsername:C,selectMeetId:S,start:Y,gameStart:h,startGame:X,toggleAudio:function(){w.value=!w.value,_.localStream.getAudioTracks().forEach((function(track){track.enabled=!track.enabled}))}}}}),E=n(65),component=Object(E.a)(L,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[e.gameStart?n("div",{staticClass:"screen"},[n("canvas",{attrs:{id:"game",width:"800",height:"400"}}),e._v(" "),n("div",{staticClass:"players_cam"},[n("div",{staticClass:"players_cam__container"},e._l(e.registeredPlayer.filter((function(e){return void 0!==e.peerCall})),(function(t,i){return n("div",{key:i,staticClass:"players_cam__box"},[n("video",{staticClass:"players_cam__video",attrs:{id:"player_video_"+t.id,autoplay:"true"}}),e._v(" "),n("div",{staticClass:"players_cam__name"},[e._v(e._s(t.name))])])})),0)]),e._v(" "),n("div",{staticClass:"self_cam"},[n("div",{staticClass:"self_cam__container"},[n("video",{attrs:{id:"self_cam__video",autoplay:"true",muted:""},domProps:{muted:!0}}),e._v(" "),n("div",{staticClass:"self_cam__toggle"},[n("button",{staticClass:"btn btn-sm",class:{"btn-success":!e.muteAudio,"btn-danger":e.muteAudio},on:{click:e.toggleAudio}},[e.muteAudio?n("font-awesome-icon",{attrs:{icon:["fas","microphone-slash"]}}):n("font-awesome-icon",{staticClass:"mx-1",attrs:{icon:["fas","microphone"]}})],1)])])])]):n("div",{staticClass:"screen"},[n("div",{staticClass:"h-full flex flex-col justify-center mx-6 md:mx-72 lg:mx-96"},[n("div",{staticClass:"container"},[n("div",{},[n("div",{staticClass:"card"},[n("div",{staticClass:"card-body"},[n("div",{staticClass:"form-group mb-3"},[n("label",{attrs:{for:"inputSelectCamera"}},[e._v("Pilih Camera")]),e._v(" "),n("select",{directives:[{name:"model",rawName:"v-model",value:e.selectCamera,expression:"selectCamera"}],staticClass:"form-control",attrs:{id:"inputSelectCamera"},on:{change:function(t){var n=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){return"_value"in e?e._value:e.value}));e.selectCamera=t.target.multiple?n:n[0]}}},e._l(e.cameraDevice,(function(t,i){return n("option",{key:i,domProps:{value:i}},[e._v(e._s(t.label))])})),0)]),e._v(" "),n("div",{staticClass:"form-group mb-3"},[n("label",{attrs:{for:"inputSelectAudio"}},[e._v("Pilih Audio")]),e._v(" "),n("select",{directives:[{name:"model",rawName:"v-model",value:e.selectAudio,expression:"selectAudio"}],staticClass:"form-control",attrs:{id:"inputSelectAudio"},on:{change:function(t){var n=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){return"_value"in e?e._value:e.value}));e.selectAudio=t.target.multiple?n:n[0]}}},e._l(e.audioDevice,(function(t,i){return n("option",{key:i,domProps:{value:i}},[e._v(e._s(t.label||"Default Audio"))])})),0)]),e._v(" "),n("div",{staticClass:"form-group mb-3"},[n("label",{attrs:{for:"inputSelectCamera"}},[e._v("Username")]),e._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:e.selectUsername,expression:"selectUsername"}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:e.selectUsername},on:{input:function(t){t.target.composing||(e.selectUsername=t.target.value)}}})]),e._v(" "),n("div",{staticClass:"form-group mb-3"},[n("label",{attrs:{for:"inputSelectCamera"}},[e._v("Pilih Meeting Room")]),e._v(" "),n("select",{staticClass:"form-control",attrs:{id:"inputSelectCamera"}},e._l(e.meetings,(function(t,i){return n("option",{key:i,domProps:{value:i}},[e._v(e._s(t))])})),0)]),e._v(" "),n("div",{staticClass:"d-grid"},[n("button",{staticClass:"btn btn-primary",attrs:{type:"button"},on:{click:e.start}},[e._v("Mulai")])])])])])])])])])}),[],!1,null,null,null);t.default=component.exports}}]);